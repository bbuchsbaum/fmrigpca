% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/parcel.R
\name{estimate_ar_whitener_parcel}
\alias{estimate_ar_whitener_parcel}
\title{Estimate AR(p) whitener from parcel-level data}
\usage{
estimate_ar_whitener_parcel(cnv_run, wm_parcels = NULL, p = 1L)
}
\arguments{
\item{cnv_run}{A \code{ClusteredNeuroVec} run.}

\item{wm_parcels}{Optional integer indices of WM parcels for more robust
AR estimation.}

\item{p}{Integer AR order (default 1). Use higher orders for data with
stronger temporal autocorrelation.}
}
\value{
List with components:
\describe{
\item{Q}{Inverse Cholesky factor (whitening matrix)}
\item{Sigma}{Regularized AR covariance matrix}
\item{phi}{AR coefficients of length p}
}
}
\description{
Parcel analogue of \code{estimate_ar_whitener()} that uses the parcel mean or
optional \code{wm_parcels} subset to estimate AR(p) via Yuleâ€“Walker.
}
\details{
The time series is formed as the mean across parcels, optionally restricted
to white-matter parcels if \code{wm_parcels} indices are provided. The series is
standardized and AR(p) coefficients are estimated via \code{stats::ar.yw}. The
implied Toeplitz covariance matrix is regularized to ensure positive
definiteness. Returns the whitener \code{Q = chol(Sigma)^{-1}} for use in the
row metric construction.
}
\examples{
\dontrun{
# Estimate AR(1) whitener using WM parcels
arw <- estimate_ar_whitener_parcel(cnv_run, wm_parcels = c(1,2,3), p = 1)
}

}
\seealso{
\code{\link[=estimate_ar_whitener]{estimate_ar_whitener()}} for voxel-level AR whitening

Other temporal metrics: 
\code{\link{build_temporal_metric}()},
\code{\link{build_temporal_metric_parcel}()},
\code{\link{estimate_ar_whitener}()},
\code{\link{make_frame_weights}()},
\code{\link{make_temporal_penalty}()}
}
\concept{temporal metrics}
