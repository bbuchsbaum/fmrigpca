% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/parcel.R
\name{build_temporal_metric_parcel}
\alias{build_temporal_metric_parcel}
\title{Build temporal covariance metric for parcellated fMRI data}
\usage{
build_temporal_metric_parcel(
  cnv_run,
  wm_parcels = NULL,
  p = 1L,
  FD = NULL,
  DVARS = NULL,
  lambda_t = 0.3,
  ridge = 1e-06
)
}
\arguments{
\item{cnv_run}{A \code{ClusteredNeuroVec} run.}

\item{wm_parcels}{Optional integer indices of WM parcels for AR estimation.}

\item{p}{AR order (default 1). Higher orders model longer-range dependencies.}

\item{FD, DVARS}{Optional motion metrics for the run. FD is framewise
displacement (mm), DVARS is temporal derivative of signal variance.
See \code{\link{make_frame_weights}} for detailed definitions.}

\item{lambda_t}{Temporal penalty weight (default 0.3). Higher values enforce
more temporal smoothness.}

\item{ridge}{Small ridge added to ensure positive definiteness (default 1e-6).}
}
\value{
Symmetric positive definite \code{Matrix} (T x T).
}
\description{
Constructs a temporal covariance metric (row metric M) for parcellated fMRI
data in \code{ClusteredNeuroVec} format. This is the parcel-level analogue of
\code{build_temporal_metric()} for voxel data.
}
\details{
The metric is \verb{M = W^\{1/2\} Q' H Q W^\{1/2\} + ridge * I}, where:
\itemize{
\item \code{Q} whitens the temporal covariance from AR(p) estimation
\item \code{H} is the second-difference temporal smoothness penalty
\item \code{W} is diagonal frame weighting from motion parameters
}
This parcel-level implementation uses parcel-averaged time series for AR
estimation, providing computational efficiency for high-dimensional data.
}
\examples{
\dontrun{
# Build temporal metric with AR(1) whitening and motion regressors
M <- build_temporal_metric_parcel(cnv_run, wm_parcels = c(1,2,3),
                                  FD = fd_vals, DVARS = dvars_vals)
}

}
\seealso{
\code{\link[=build_temporal_metric]{build_temporal_metric()}} for voxel-level temporal metric construction

Other temporal metrics: 
\code{\link{build_temporal_metric}()},
\code{\link{estimate_ar_whitener}()},
\code{\link{estimate_ar_whitener_parcel}()},
\code{\link{make_frame_weights}()},
\code{\link{make_temporal_penalty}()}
}
\concept{temporal metrics}
